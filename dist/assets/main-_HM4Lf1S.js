import"./style-C71kK-Ym.js";import{createClient as l}from"https://esm.sh/@supabase/supabase-js@2";const d="https://kdijhjnkxkrfjlyavcoe.supabase.co",u="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtkaWpoam5reGtyZmpseWF2Y29lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEyMDcyNDMsImV4cCI6MjA2Njc4MzI0M30.0EpnU9W3_O0b94Twy0FXdgtT49jByEO7tx2et-nQySA";let o;try{o=l(d,u),console.log("Supabase client initialized successfully")}catch(r){console.error("Failed to initialize Supabase client:",r),alert("Error connecting to the database. Please try again later.")}function m(){document.querySelectorAll("[data-bg]").forEach(t=>{const n=t.getAttribute("data-bg");if(n){const e=document.createElement("div");e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.backgroundImage=n,e.style.backgroundSize=t.id==="hero"?"cover":"contain",e.style.backgroundPosition="center",e.style.backgroundRepeat="no-repeat",e.style.zIndex="1",(t.id==="welcome"||t.id==="hero")&&(e.style.filter="brightness(70%)"),t.insertBefore(e,t.firstChild)}})}async function g(r){var a;if(r.preventDefault(),!o){console.error("Supabase client is not initialized"),alert("Cannot submit review: Database connection failed.");return}const t=r.target,n=t.querySelector("#username").value,e=(a=t.querySelector('input[name="rating"]:checked'))==null?void 0:a.value,s=t.querySelector("#reviewText").value;if(!n||!e||!s){alert("Please fill out all fields and select a rating.");return}try{const{error:i}=await o.from("reviews").insert([{name:n,rating:parseInt(e),review:s}]);if(i){console.error("Error submitting review:",i),alert(`Failed to submit review: ${i.message}`);return}new bootstrap.Toast(document.getElementById("successToast")).show(),t.reset(),c()}catch(i){console.error("Unexpected error submitting review:",i),alert("An unexpected error occurred. Please try again.")}}async function c(){if(!o){console.error("Supabase client is not initialized"),document.getElementById("reviewList").innerHTML='<p class="text-danger text-center">Error: Database connection failed.</p>';return}try{const{data:r,error:t}=await o.from("reviews").select("*").order("created_at",{ascending:!1});if(t)throw console.error("Error fetching reviews:",t),new Error(`Failed to fetch reviews: ${t.message}`);const n=document.getElementById("reviewList");if(!n){console.error("Review list element not found");return}if(n.innerHTML="",!r||r.length===0){n.innerHTML='<p class="text-center text-light">No reviews yet.</p>';return}r.forEach(e=>{const s="★".repeat(e.rating)+"☆".repeat(5-e.rating),a=`
        <div class="review-card mb-3 p-3 bg-dark text-light rounded">
          <h5 class="fw-bold">${e.name}</h5>
          <p class="text-warning">${s}</p>
          <p>${e.review}</p>
        </div>
      `;n.insertAdjacentHTML("beforeend",a)})}catch(r){console.error("Error displaying reviews:",r);const t=document.getElementById("reviewList");t&&(t.innerHTML=`<p class="text-danger text-center">Error loading reviews: ${r.message}</p>`)}}document.addEventListener("DOMContentLoaded",()=>{console.log("DOM loaded, initializing..."),m();const r=document.getElementById("reviewForm");r?r.addEventListener("submit",g):console.error("Review form element not found"),c()});
