import"./style-C71kK-Ym.js";import{createClient as m}from"https://esm.sh/@supabase/supabase-js@2";const u=m("https://kdijhjnkxkrfjlyavcoe.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtkaWpoam5reGtyZmpseWF2Y29lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEyMDcyNDMsImV4cCI6MjA2Njc4MzI0M30.0EpnU9W3_O0b94Twy0FXdgtT49jByEO7tx2et-nQySA");console.log("Supabase URL:","https://kdijhjnkxkrfjlyavcoe.supabase.co");console.log("Supabase Key:","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtkaWpoam5reGtyZmpseWF2Y29lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEyMDcyNDMsImV4cCI6MjA2Njc4MzI0M30.0EpnU9W3_O0b94Twy0FXdgtT49jByEO7tx2et-nQySA");document.getElementById("add-product-form").addEventListener("submit",async t=>{t.preventDefault();const s=document.getElementById("alert-message");s.classList.remove("show","alert-success","alert-danger"),s.textContent="";const n=document.getElementById("model").value.trim(),i=document.getElementById("specifications").value.trim(),o=parseFloat(document.getElementById("price").value),c=document.getElementById("image-urls").value.trim(),l=document.getElementById("phone-number").value.trim();let a=document.getElementById("whatsapp-number").value.trim();if(a=a.replace(/^\+/,""),!n||!i||isNaN(o)||o<0){r("Please fill in all required fields correctly.","danger");return}if(!I(l)){r("Invalid phone number format. Use + followed by 10-15 digits (e.g., +1234567890).","danger");return}if(!g(a)){r("Invalid WhatsApp number format. Use 10-15 digits without + (e.g., 1234567890).","danger");return}const d=c?c.split(",").map(e=>e.trim().replace(/\/+/g,"/")).map(e=>e.includes("supabase.co/storage/v1/object/public")?e.replace(/(\/public\/)/,"/public/"):e).filter(p):[];if(d.length===0){r("Please provide at least one valid image URL.","danger");return}try{const{error:e}=await u.from("laptops").insert({model:n,specifications:i,price:o,image_urls:d,phone_number:l,whatsapp_number:a,is_in_stock:document.getElementById("is-in-stock").checked});if(e)throw console.error("Supabase error:",e),e.code==="42501"?new Error("Unauthorized: Check RLS policies on the laptops table. Public inserts may not be allowed."):e.code==="23514"?new Error("Invalid WhatsApp number format in database. Ensure it contains only 10-15 digits with no + or other characters."):new Error(`Supabase error: ${e.message} (Code: ${e.code})`);r("Product added successfully!","success"),document.getElementById("add-product-form").reset(),document.getElementById("is-in-stock").checked=!0}catch(e){console.error("Error adding product:",e),r(`Failed to add product: ${e.message}`,"danger")}});function p(t){try{return new URL(t),!0}catch{return!1}}function I(t){return/^\+?\d{10,15}$/.test(t)}function g(t){return/^\d{10,15}$/.test(t)}function r(t,s){const n=document.getElementById("alert-message");n.textContent=t,n.classList.add("show",`alert-${s}`)}
